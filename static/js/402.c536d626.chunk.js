"use strict";(self.webpackChunkform_salary_page=self.webpackChunkform_salary_page||[]).push([[402],{5402:(n,l,o)=>{o.r(l),o.d(l,{default:()=>v});var i=o(5043),u=o(6244),t=o(443),a=o(3402),e=o(579);const r=new a.qw({id:"application-0-ndmukzx"}),d=r.currentUser,v=()=>{const[,n]=(0,i.useState)(!0),[l,o]=(0,i.useState)({}),[a,v]=(0,i.useState)({}),[c,h]=(0,i.useState)(null),[s,_]=(0,i.useState)({}),[,p]=(0,i.useState)([]),[,g]=(0,i.useState)(!1),[,m]=(0,i.useState)(r.currentUser),[y,f]=(0,i.useState)("");(0,i.useEffect)((()=>{d?T(d):n(!1)}),[]);const T=async l=>{try{if(!l||!l.profile||!l.profile.email)throw new Error("User is not logged in or does not have an email.");const n="checkUserRole",o=await l.functions[n](l.profile.email);if(o.error)throw new Error(o.error);f(o.role),console.log("check role:",o.role),g(!0)}catch(o){console.error("Failed to check user role:",o)}finally{n(!1)}},b=(0,i.useCallback)((async()=>{try{if("admin"===y||"user"===y){var l,i,u,t;const a=d.profile;if(a){const n=a.id,l=a.email;console.log("Owner ID:",n),console.log("Owner Name:",l)}const e="salaryFormModule",r=await(null===d||void 0===d?void 0:d.callFunction(e));console.log("role: ",y),console.log("response: ",r),o(null===r||void 0===r||null===(l=r.public)||void 0===l||null===(i=l.input)||void 0===i?void 0:i.jsonSchema),v(null===r||void 0===r||null===(u=r.public)||void 0===u||null===(t=u.output)||void 0===t?void 0:t.jsonData),n(!1)}}catch(a){console.error("Error fetching data:",a),n(!1)}}),[y]);(0,i.useEffect)((()=>{b()}),[b]);const S=(0,i.useCallback)((n=>{let l=0;switch(n){case"Teaching Department":l=8e6;break;case"Technical Department":l=9e6;break;case"HR Department":l=1e7;break;case"Production Department":l=11e6;break;case"Supervision Department":l=15e6;break;case"R&D":l=2e7;break;case"CFO":l=3e7;break;case"CEO":l=4e7;break;default:l=0}_((n=>{var o,i;return(null===n||void 0===n||null===(o=n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===o||null===(i=o.Part)||void 0===i?void 0:i["L\u01b0\u01a1ng_c\u01a1_b\u1ea3n"])!==l?{...n,"Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input":{...n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"],Part:{...n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"].Part,"L\u01b0\u01a1ng_c\u01a1_b\u1ea3n":l}}}:n}))}),[]);(0,i.useEffect)((()=>{var n,l;const o=null===s||void 0===s||null===(n=s["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===n||null===(l=n.Part)||void 0===l?void 0:l.Part;o&&S(o)}),[s,S]);const N=async()=>{const n=await(null===d||void 0===d?void 0:d.callFunction("calculateNetSalary"));if(Array.isArray(n)&&n.length>0){const l=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i.Total_salary_without_tax})),o=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i["Thu\u1ebf_thu_nh\u1eadp_c\xe1_nh\xe2n"]})),i=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i["LOAN_Ti\u1ec1n_\u1ee9ng_tr\u01b0\u1edbc"]})),u=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i["Kh\u1ea5u_tr\u1eeb"]})),t=n.map((n=>{var l,o,i,u;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i||null===(u=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===u?void 0:u["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"]})),a=n.map((n=>{var l,o,i,u;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i||null===(u=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===u?void 0:u.BHXH})),e=n.map((n=>{var l,o,i,u;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i||null===(u=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===u?void 0:u.BHTN})),r=n.map((n=>{var l,o,i,u;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i||null===(u=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===u?void 0:u.BHYT})),d=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i["B\u1ea2O HI\u1ec2M"]})),v=n.map((n=>{var l,o,i;return null===(l=n.public)||void 0===l||null===(o=l.output)||void 0===o||null===(i=o.calculation)||void 0===i?void 0:i["L\u01b0\u01a1ng_th\u1ef1c_l\xe3nh"]})),c=l[l.length-1],h=o[o.length-1],s=i[i.length-1],_=u[u.length-1],g=t[t.length-1],m=a[a.length-1],y=e[e.length-1],f=r[r.length-1],T=d[d.length-1],b=v[v.length-1];if(void 0!==c||void 0!==h||void 0!==s||void 0!==_||void 0!==g||void 0!==m||void 0!==y||void 0!==f||void 0!==T||void 0!==b){p((n=>Array.isArray(n)?[...n,c]:[c])),p((n=>Array.isArray(n)?[...n,h]:[h])),p((n=>Array.isArray(n)?[...n,s]:[s])),p((n=>Array.isArray(n)?[...n,_]:[_])),p((n=>Array.isArray(n)?[...n,g]:[g])),p((n=>Array.isArray(n)?[...n,m]:[m])),p((n=>Array.isArray(n)?[...n,y]:[y])),p((n=>Array.isArray(n)?[...n,f]:[f])),p((n=>Array.isArray(n)?[...n,T]:[T])),p((n=>Array.isArray(n)?[...n,b]:[b]));return{Salary_no_tax:{Total_salary:c},"Thu\u1ebf_TNCN":{"Thu\u1ebf_TNCN":h},"LOAN_Ti\u1ec1n \u1ee9ng tr\u01b0\u1edbc":{Loan_amount:s},"EXPENSE REIMBURSEMENT - KH\u1ea4U TR\u1eea":{Expense:_},"L\u01b0\u01a1ng \u0111\xf3ng b\u1ea3o hi\u1ec3m":{BHXH:m,BHTN:y,BHYT:f,"L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m":g},"B\u1ea2O HI\u1ec2M":{"Th\xe0nh_ti\u1ec1n_BH":T},"L\u01af\u01a0NG TH\u1ef0C L\xc3NH":b}}console.error("Kh\xf4ng t\xecm th\u1ea5y gi\xe1 tr\u1ecb trong ph\u1ea3n h\u1ed3i.")}else console.error("Ph\u1ea3n h\u1ed3i kh\xf4ng ph\u1ea3i l\xe0 m\u1ed9t m\u1ea3ng ho\u1eb7c r\u1ed7ng.")};return(0,e.jsx)(e.Fragment,{children:d?(0,e.jsxs)("div",{className:"flex justify-center",children:[(0,e.jsx)("button",{onClick:async()=>{d&&(await d.logOut(),m(null),g(!1),window.location.reload(!0),window.location.href="/form-salary-page")},children:"Logout"}),(0,e.jsxs)("p",{children:["Role: ",y]}),"admin"===y?(0,e.jsx)("div",{children:"Admin Content"}):(0,e.jsx)("div",{children:"Access Denied"}),l?(0,e.jsx)(u.Ay,{schema:l,validator:t.Ay,formData:s,onSubmit:async n=>{try{if(n){var l,o,i,u,t,a,e,v,c,s,_,p,g,m,y,f,T,S,D,A,I,H,k,B,L,E,w;const x=null===(l=n.formData)||void 0===l||null===(o=l["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===o?void 0:o["Th\xf4ng_tin_nh\xe2n_vi\xean"],j=null===(i=n.formData)||void 0===i||null===(u=i["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===u?void 0:u.Part,O=null===(t=n.formData)||void 0===t||null===(a=t["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===a||null===(e=a.Plan)||void 0===e?void 0:e["Ch\u1ec9_ti\xeau"],C=null===(v=n.formData)||void 0===v||null===(c=v["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===c?void 0:c.Budget_performance,P=null===(s=n.formData)||void 0===s||null===(_=s["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===_?void 0:_.Bonus,R=null===(p=n.formData)||void 0===p||null===(g=p["Thu\u1ebf TNCN Input"])||void 0===g?void 0:g.input,M=null===(m=n.formData)||void 0===m||null===(y=m["LOAN_Ti\u1ec1n \u1ee9ng tr\u01b0\u1edbc Input"])||void 0===y?void 0:y.input,F=null===(f=n.formData)||void 0===f||null===(T=f["EXPENSE REIMBURSEMENT - KH\u1ea4U TR\u1eea Input"])||void 0===T?void 0:T.input,U=null===(S=n.formData)||void 0===S||null===(D=S["B\u1ea2O HI\u1ec2M"])||void 0===D?void 0:D.Input,K={user:d.id,Name:null===x||void 0===x?void 0:x.Name,ID:null===x||void 0===x?void 0:x.ID,Part:null===j||void 0===j?void 0:j.Part,BasicSalary:null===j||void 0===j?void 0:j["L\u01b0\u01a1ng_c\u01a1_b\u1ea3n"],KPIs:(null===O||void 0===O?void 0:O.map((n=>({NameTaget:null===n||void 0===n?void 0:n["T\xean_ch\u1ec9_ti\xeau"],Money:null===n||void 0===n?void 0:n["S\u1ed1_ti\u1ec1n"]}))))||[],Balance:C,Bonus:P},X={Date:R.Datetime,FullName:null===R||void 0===R?void 0:R["T\xean_nh\xe2n_vi\xean"],ID:null===R||void 0===R?void 0:R.ID,SalaryNoTax:null===R||void 0===R?void 0:R["L\u01b0\u01a1ng_ch\u01b0a_thu\u1ebf"],Level:null===R||void 0===R?void 0:R["H\u1ec7_s\u1ed1"],ReduceYourSelf:null===R||void 0===R?void 0:R["Gi\u1ea3m tr\u1eeb b\u1ea3n th\xe2n"],InsuranceFees:null===R||void 0===R?void 0:R["B\u1ea3o_hi\u1ec3m"]},Y={LoanRegistrationTime:M.Datetime,ExpriedDay:M.Expired_days,LoanType:M.Loan_type,StaffName:M.Name,RefundDay:M.Refund_date,Money:M.Value},z={NotEnoughTargetStudent:{StudentNumber:null===F||void 0===F||null===(A=F["S\u1ed1_h\u1ecdc_vi\xean_kh\xf4ng_\u0111\u1ee7_ch\u1ec9_ti\xeau "])||void 0===A?void 0:A["S\u1ed1_l\u01b0\u1ee3ng_h\u1ecdc_vi\xean"],StudentMoney:null===F||void 0===F||null===(I=F["S\u1ed1_h\u1ecdc_vi\xean_kh\xf4ng_\u0111\u1ee7_ch\u1ec9_ti\xeau "])||void 0===I?void 0:I["S\u1ed1_ti\u1ec1n_HV"]},DefautFee:null===F||void 0===F||null===(H=F["Default fee"])||void 0===H?void 0:H["S\u1ed1_ti\u1ec1n_Def"],Outsourcing:null===F||void 0===F||null===(k=F.Outsourcing)||void 0===k?void 0:k["S\u1ed1_ti\u1ec1n_Outs"],UnauthorizedDayoff:{DayNumber:null===F||void 0===F||null===(B=F["S\u1ed1_ng\xe0y_ngh\u1ec9_kh\xf4ng_ph\xe9p"])||void 0===B?void 0:B["S\u1ed1_ng\xe0y"],MoneyOfDayoff:null===F||void 0===F||null===(L=F["S\u1ed1_ng\xe0y_ngh\u1ec9_kh\xf4ng_ph\xe9p"])||void 0===L?void 0:L["S\u1ed1_ti\u1ec1n_tr\xean_m\u1ed9t_ng\xe0y_ngh\u1ec9"]},LackTargets:(null===F||void 0===F||null===(E=F.Thi\u1ebfu_ch\u1ec9_ti\u00eau)||void 0===E?void 0:E.map((n=>({TargetName:null===n||void 0===n?void 0:n["T\xean_ch\u1ec9_ti\xeau"],RegisterName:null===n||void 0===n?void 0:n["Ng\u01b0\u1eddi_\u0111\u0103ng_k\xfd"],CompensationMoney:null===n||void 0===n?void 0:n["S\u1ed1_ti\u1ec1n_b\u1ed3i_th\u01b0\u1eddng"]}))))||[]},G={BHTN:null===U||void 0===U?void 0:U.BHTN,BHXH:null===U||void 0===U?void 0:U.BHXH,BHYT:null===U||void 0===U?void 0:U.BHYT,SalaryInsurance:null===U||void 0===U?void 0:U["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"]},V={"Ng\u01b0\u1eddi_d\xf9ng":d.id,"Thu_nh\u1eadp_ch\u1ecbu_thu\u1ebf":K,"Thu\u1ebf_thu_nh\u1eadp_c\xe1_nh\xe2n":X,"LOAN_Ti\u1ec1n_\u1ee9ng_tr\u01b0\u1edbc":Y,"Kh\u1ea5u_tr\u1eeb":z,"B\u1ea3o_hi\u1ec3m":G},q=await(null===(w=r.currentUser)||void 0===w?void 0:w.callFunction("receivedData1",V)),J=await N(n.formData);return h(J),b(),q}console.error("Form data is missing or invalid.")}catch(x){console.error("Error fetching data:",x)}},onChange:n=>{"admin"===y&&_(n.formData)}}):(0,e.jsx)("div",{children:"Kh\xf4ng c\xf3 jsonSchemaCalculateNetSalaryInput"}),a?(0,e.jsx)(u.Ay,{schema:a,validator:t.Ay,disabled:!0,formData:c,uiSchema:{"ui:submitButtonOptions":{norender:!0}}}):(0,e.jsx)("div",{children:"Kh\xf4ng c\xf3 jsonSchemaCalculateNetSalaryOutput"})]}):(0,e.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,e.jsx)("div",{className:"text-gray-600 text-lg",children:"Please log in to view this content."})})})}}}]);
//# sourceMappingURL=402.c536d626.chunk.js.map