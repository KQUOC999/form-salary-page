"use strict";(self.webpackChunkform_salary_page=self.webpackChunkform_salary_page||[]).push([[689,402],{8689:(n,o,l)=>{l.r(o),l.d(o,{default:()=>h});var i=l(5043),t=l(3402),a=l(6244),e=l(443),r=l(5402),u=l(579);const d=new t.qw({id:"application-0-ndmukzx"}),c=d.currentUser,s={title:"Register",type:"object",required:["email","password"],properties:{email:{type:"string",title:"Email",format:"email"},password:{type:"string",title:"Password",minLength:6,format:"password"}}},v={title:"Login",type:"object",required:["email","password"],properties:{email:{type:"string",title:"Email",format:"email"},password:{type:"string",title:"Password",minLength:6,format:"password"}}},h=()=>{const[,n]=(0,i.useState)(null),[o,l]=(0,i.useState)(!1),[h,m]=(0,i.useState)(!0),[_,p]=(0,i.useState)(!1);return(0,u.jsx)("div",{children:c?(0,u.jsx)(u.Fragment,{children:_&&h?(0,u.jsx)("p",{children:"Loading..."}):(0,u.jsx)(r.default,{})}):(0,u.jsx)("div",{className:"overlay-container",children:(0,u.jsx)("div",{className:"overlay-content",children:(0,u.jsx)("div",{className:"container_form",children:o?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{className:"button1",onClick:()=>l(!1),children:"Quay l\u1ea1i"}),(0,u.jsx)(a.Ay,{className:"custom-form",schema:s,validator:e.Ay,onSubmit:async n=>{const{email:o,password:l}=n.formData;try{await d.emailPasswordAuth.registerUser({email:o,password:l}),window.location.reload(!0)}catch(i){console.log(i.error)}}})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{className:"button1",onClick:()=>l(!0),children:"\u0110\u0103ng k\xfd"}),(0,u.jsx)(a.Ay,{className:"custom-form",schema:v,validator:e.Ay,onSubmit:async o=>{const{email:l,password:i}=o.formData;try{const o=t.Ji.emailPassword(l,i),a=await d.logIn(o);m(!1),n(a),p(!0),window.location.reload(!0),window.location.href="/form-salary-page"}catch(a){console.log(a.error)}}})]})})})})})}},5402:(n,o,l)=>{l.r(o),l.d(o,{default:()=>c});var i=l(5043),t=l(6244),a=l(443),e=l(3402),r=l(579);const u=new e.qw({id:"application-0-ndmukzx"}),d=u.currentUser,c=()=>{const[,n]=(0,i.useState)(!0),[o,l]=(0,i.useState)({}),[e,c]=(0,i.useState)({}),[s,v]=(0,i.useState)(null),[h,m]=(0,i.useState)({}),[,_]=(0,i.useState)([]),[,p]=(0,i.useState)(!1),[,g]=(0,i.useState)(u.currentUser),[y,f]=(0,i.useState)("");(0,i.useEffect)((()=>{d?T(d):n(!1)}),[]);const T=async o=>{try{if(!o||!o.profile||!o.profile.email)throw new Error("User is not logged in or does not have an email.");const n="checkUserRole",l=await o.functions[n](o.profile.email);if(l.error)throw new Error(l.error);f(l.role),console.log("check role:",l.role),p(!0)}catch(l){console.error("Failed to check user role:",l)}finally{n(!1)}},b=(0,i.useCallback)((async()=>{try{if("admin"===y||"user"===y){var o,i,t,a;const e=d.profile;if(e){const n=e.id,o=e.email;console.log("Owner ID:",n),console.log("Owner Name:",o)}const r="salaryFormModule",u=await(null===d||void 0===d?void 0:d.callFunction(r));console.log("role: ",y),console.log("response: ",u),l(null===u||void 0===u||null===(o=u.public)||void 0===o||null===(i=o.input)||void 0===i?void 0:i.jsonSchema),c(null===u||void 0===u||null===(t=u.public)||void 0===t||null===(a=t.output)||void 0===a?void 0:a.jsonData),n(!1)}}catch(e){console.error("Error fetching data:",e),n(!1)}}),[y]);(0,i.useEffect)((()=>{b()}),[b]);const S=(0,i.useCallback)((n=>{let o=0;switch(n){case"Teaching Department":o=8e6;break;case"Technical Department":o=9e6;break;case"HR Department":o=1e7;break;case"Production Department":o=11e6;break;case"Supervision Department":o=15e6;break;case"R&D":o=2e7;break;case"CFO":o=3e7;break;case"CEO":o=4e7;break;default:o=0}m((n=>{var l,i;return(null===n||void 0===n||null===(l=n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===l||null===(i=l.Part)||void 0===i?void 0:i["L\u01b0\u01a1ng_c\u01a1_b\u1ea3n"])!==o?{...n,"Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input":{...n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"],Part:{...n["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"].Part,"L\u01b0\u01a1ng_c\u01a1_b\u1ea3n":o}}}:n}))}),[]);(0,i.useEffect)((()=>{var n,o;const l=null===h||void 0===h||null===(n=h["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===n||null===(o=n.Part)||void 0===o?void 0:o.Part;l&&S(l)}),[h,S]);const N=async()=>{const n=await(null===d||void 0===d?void 0:d.callFunction("calculateNetSalary"));if(Array.isArray(n)&&n.length>0){const o=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i.Total_salary_without_tax})),l=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i["Thu\u1ebf_thu_nh\u1eadp_c\xe1_nh\xe2n"]})),i=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i["LOAN_Ti\u1ec1n_\u1ee9ng_tr\u01b0\u1edbc"]})),t=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i["Kh\u1ea5u_tr\u1eeb"]})),a=n.map((n=>{var o,l,i,t;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i||null===(t=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===t?void 0:t["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"]})),e=n.map((n=>{var o,l,i,t;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i||null===(t=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===t?void 0:t.BHXH})),r=n.map((n=>{var o,l,i,t;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i||null===(t=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===t?void 0:t.BHTN})),u=n.map((n=>{var o,l,i,t;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i||null===(t=i["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"])||void 0===t?void 0:t.BHYT})),d=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i["B\u1ea2O HI\u1ec2M"]})),c=n.map((n=>{var o,l,i;return null===(o=n.public)||void 0===o||null===(l=o.output)||void 0===l||null===(i=l.calculation)||void 0===i?void 0:i["L\u01b0\u01a1ng_th\u1ef1c_l\xe3nh"]})),s=o[o.length-1],v=l[l.length-1],h=i[i.length-1],m=t[t.length-1],p=a[a.length-1],g=e[e.length-1],y=r[r.length-1],f=u[u.length-1],T=d[d.length-1],b=c[c.length-1];if(void 0!==s||void 0!==v||void 0!==h||void 0!==m||void 0!==p||void 0!==g||void 0!==y||void 0!==f||void 0!==T||void 0!==b){_((n=>Array.isArray(n)?[...n,s]:[s])),_((n=>Array.isArray(n)?[...n,v]:[v])),_((n=>Array.isArray(n)?[...n,h]:[h])),_((n=>Array.isArray(n)?[...n,m]:[m])),_((n=>Array.isArray(n)?[...n,p]:[p])),_((n=>Array.isArray(n)?[...n,g]:[g])),_((n=>Array.isArray(n)?[...n,y]:[y])),_((n=>Array.isArray(n)?[...n,f]:[f])),_((n=>Array.isArray(n)?[...n,T]:[T])),_((n=>Array.isArray(n)?[...n,b]:[b]));return{Salary_no_tax:{Total_salary:s},"Thu\u1ebf_TNCN":{"Thu\u1ebf_TNCN":v},"LOAN_Ti\u1ec1n \u1ee9ng tr\u01b0\u1edbc":{Loan_amount:h},"EXPENSE REIMBURSEMENT - KH\u1ea4U TR\u1eea":{Expense:m},"L\u01b0\u01a1ng \u0111\xf3ng b\u1ea3o hi\u1ec3m":{BHXH:g,BHTN:y,BHYT:f,"L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m":p},"B\u1ea2O HI\u1ec2M":{"Th\xe0nh_ti\u1ec1n_BH":T},"L\u01af\u01a0NG TH\u1ef0C L\xc3NH":b}}console.error("Kh\xf4ng t\xecm th\u1ea5y gi\xe1 tr\u1ecb trong ph\u1ea3n h\u1ed3i.")}else console.error("Ph\u1ea3n h\u1ed3i kh\xf4ng ph\u1ea3i l\xe0 m\u1ed9t m\u1ea3ng ho\u1eb7c r\u1ed7ng.")};return(0,r.jsx)(r.Fragment,{children:d?(0,r.jsxs)("div",{className:"flex justify-center",children:[(0,r.jsx)("button",{onClick:async()=>{d&&(await d.logOut(),g(null),p(!1),window.location.reload(!0),window.location.href="/form-login-page")},children:"Logout"}),(0,r.jsxs)("p",{children:["Role: ",y]}),"admin"===y?(0,r.jsx)("div",{children:"Admin Content"}):(0,r.jsx)("div",{children:"Access Denied"}),o?(0,r.jsx)(t.Ay,{schema:o,validator:a.Ay,formData:h,onSubmit:async n=>{try{if(n){var o,l,i,t,a,e,r,c,s,h,m,_,p,g,y,f,T,S,w,D,x,A,j,k,L,I,H;const B=null===(o=n.formData)||void 0===o||null===(l=o["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===l?void 0:l["Th\xf4ng_tin_nh\xe2n_vi\xean"],E=null===(i=n.formData)||void 0===i||null===(t=i["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===t?void 0:t.Part,C=null===(a=n.formData)||void 0===a||null===(e=a["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===e||null===(r=e.Plan)||void 0===r?void 0:r["Ch\u1ec9_ti\xeau"],P=null===(c=n.formData)||void 0===c||null===(s=c["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===s?void 0:s.Budget_performance,O=null===(h=n.formData)||void 0===h||null===(m=h["Thu nh\u1eadp ch\u1ecbu thu\u1ebf Input"])||void 0===m?void 0:m.Bonus,R=null===(_=n.formData)||void 0===_||null===(p=_["Thu\u1ebf TNCN Input"])||void 0===p?void 0:p.input,F=null===(g=n.formData)||void 0===g||null===(y=g["LOAN_Ti\u1ec1n \u1ee9ng tr\u01b0\u1edbc Input"])||void 0===y?void 0:y.input,M=null===(f=n.formData)||void 0===f||null===(T=f["EXPENSE REIMBURSEMENT - KH\u1ea4U TR\u1eea Input"])||void 0===T?void 0:T.input,U=null===(S=n.formData)||void 0===S||null===(w=S["B\u1ea2O HI\u1ec2M"])||void 0===w?void 0:w.Input,K={user:d.id,Name:null===B||void 0===B?void 0:B.Name,ID:null===B||void 0===B?void 0:B.ID,Part:null===E||void 0===E?void 0:E.Part,BasicSalary:null===E||void 0===E?void 0:E["L\u01b0\u01a1ng_c\u01a1_b\u1ea3n"],KPIs:(null===C||void 0===C?void 0:C.map((n=>({NameTaget:null===n||void 0===n?void 0:n["T\xean_ch\u1ec9_ti\xeau"],Money:null===n||void 0===n?void 0:n["S\u1ed1_ti\u1ec1n"]}))))||[],Balance:P,Bonus:O},X={Date:R.Datetime,FullName:null===R||void 0===R?void 0:R["T\xean_nh\xe2n_vi\xean"],ID:null===R||void 0===R?void 0:R.ID,SalaryNoTax:null===R||void 0===R?void 0:R["L\u01b0\u01a1ng_ch\u01b0a_thu\u1ebf"],Level:null===R||void 0===R?void 0:R["H\u1ec7_s\u1ed1"],ReduceYourSelf:null===R||void 0===R?void 0:R["Gi\u1ea3m tr\u1eeb b\u1ea3n th\xe2n"],InsuranceFees:null===R||void 0===R?void 0:R["B\u1ea3o_hi\u1ec3m"]},Y={LoanRegistrationTime:F.Datetime,ExpriedDay:F.Expired_days,LoanType:F.Loan_type,StaffName:F.Name,RefundDay:F.Refund_date,Money:F.Value},q={NotEnoughTargetStudent:{StudentNumber:null===M||void 0===M||null===(D=M["S\u1ed1_h\u1ecdc_vi\xean_kh\xf4ng_\u0111\u1ee7_ch\u1ec9_ti\xeau "])||void 0===D?void 0:D["S\u1ed1_l\u01b0\u1ee3ng_h\u1ecdc_vi\xean"],StudentMoney:null===M||void 0===M||null===(x=M["S\u1ed1_h\u1ecdc_vi\xean_kh\xf4ng_\u0111\u1ee7_ch\u1ec9_ti\xeau "])||void 0===x?void 0:x["S\u1ed1_ti\u1ec1n_HV"]},DefautFee:null===M||void 0===M||null===(A=M["Default fee"])||void 0===A?void 0:A["S\u1ed1_ti\u1ec1n_Def"],Outsourcing:null===M||void 0===M||null===(j=M.Outsourcing)||void 0===j?void 0:j["S\u1ed1_ti\u1ec1n_Outs"],UnauthorizedDayoff:{DayNumber:null===M||void 0===M||null===(k=M["S\u1ed1_ng\xe0y_ngh\u1ec9_kh\xf4ng_ph\xe9p"])||void 0===k?void 0:k["S\u1ed1_ng\xe0y"],MoneyOfDayoff:null===M||void 0===M||null===(L=M["S\u1ed1_ng\xe0y_ngh\u1ec9_kh\xf4ng_ph\xe9p"])||void 0===L?void 0:L["S\u1ed1_ti\u1ec1n_tr\xean_m\u1ed9t_ng\xe0y_ngh\u1ec9"]},LackTargets:(null===M||void 0===M||null===(I=M.Thi\u1ebfu_ch\u1ec9_ti\u00eau)||void 0===I?void 0:I.map((n=>({TargetName:null===n||void 0===n?void 0:n["T\xean_ch\u1ec9_ti\xeau"],RegisterName:null===n||void 0===n?void 0:n["Ng\u01b0\u1eddi_\u0111\u0103ng_k\xfd"],CompensationMoney:null===n||void 0===n?void 0:n["S\u1ed1_ti\u1ec1n_b\u1ed3i_th\u01b0\u1eddng"]}))))||[]},z={BHTN:null===U||void 0===U?void 0:U.BHTN,BHXH:null===U||void 0===U?void 0:U.BHXH,BHYT:null===U||void 0===U?void 0:U.BHYT,SalaryInsurance:null===U||void 0===U?void 0:U["L\u01b0\u01a1ng_\u0111\xf3ng_b\u1ea3o_hi\u1ec3m"]},G={"Ng\u01b0\u1eddi_d\xf9ng":d.id,"Thu_nh\u1eadp_ch\u1ecbu_thu\u1ebf":K,"Thu\u1ebf_thu_nh\u1eadp_c\xe1_nh\xe2n":X,"LOAN_Ti\u1ec1n_\u1ee9ng_tr\u01b0\u1edbc":Y,"Kh\u1ea5u_tr\u1eeb":q,"B\u1ea3o_hi\u1ec3m":z},V=await(null===(H=u.currentUser)||void 0===H?void 0:H.callFunction("receivedData1",G)),J=await N(n.formData);return v(J),b(),V}console.error("Form data is missing or invalid.")}catch(B){console.error("Error fetching data:",B)}},onChange:n=>{"admin"===y&&m(n.formData)}}):(0,r.jsx)("div",{children:"Kh\xf4ng c\xf3 jsonSchemaCalculateNetSalaryInput"}),e?(0,r.jsx)(t.Ay,{schema:e,validator:a.Ay,disabled:!0,formData:s,uiSchema:{"ui:submitButtonOptions":{norender:!0}}}):(0,r.jsx)("div",{children:"Kh\xf4ng c\xf3 jsonSchemaCalculateNetSalaryOutput"})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-gray-600 text-lg",children:"Please log in to view this content."})})})}}}]);
//# sourceMappingURL=689.8d8239c4.chunk.js.map